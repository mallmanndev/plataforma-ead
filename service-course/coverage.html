
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>errors: Go Coverage Report</title>
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">github.com/matheusvmallmann/plataforma-ead/service-course/application/errors/data_not_found_error.go (0.0%)</option>
				
				<option value="file1">github.com/matheusvmallmann/plataforma-ead/service-course/application/errors/grpc_parser.go (100.0%)</option>
				
				<option value="file2">github.com/matheusvmallmann/plataforma-ead/service-course/application/errors/invalid_attribute_error.go (100.0%)</option>
				
				<option value="file3">github.com/matheusvmallmann/plataforma-ead/service-course/application/errors/not_found_error.go (100.0%)</option>
				
				<option value="file4">github.com/matheusvmallmann/plataforma-ead/service-course/application/errors/permission_denied.go (100.0%)</option>
				
				<option value="file5">github.com/matheusvmallmann/plataforma-ead/service-course/application/errors/usecase_error.go (45.5%)</option>
				
				<option value="file6">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/create_course.go (100.0%)</option>
				
				<option value="file7">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/create_section.go (100.0%)</option>
				
				<option value="file8">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/delete_course.go (100.0%)</option>
				
				<option value="file9">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/delete_section.go (100.0%)</option>
				
				<option value="file10">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/update_course.go (100.0%)</option>
				
				<option value="file11">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/update_section.go (100.0%)</option>
				
				<option value="file12">github.com/matheusvmallmann/plataforma-ead/service-course/application/usecases/video_upload.go (96.8%)</option>
				
				<option value="file13">github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities/course.go (69.4%)</option>
				
				<option value="file14">github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities/course_item.go (0.0%)</option>
				
				<option value="file15">github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities/course_section.go (44.4%)</option>
				
				<option value="file16">github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities/people.go (56.2%)</option>
				
				<option value="file17">github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities/video.go (86.7%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">not covered</span>
				<span class="cov8">covered</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package errs

type DataNotFoundError struct {
        message string
}

func NewDataNotFoundError(Message string) *DataNotFoundError <span class="cov0" title="0">{
        return &amp;DataNotFoundError{Message}
}</span>

func (e *DataNotFoundError) Error() string <span class="cov0" title="0">{
        return e.message
}</span>
</pre>
		
		<pre class="file" id="file1" style="display: none">package errs

import (
        "errors"
        "fmt"
        "google.golang.org/grpc/codes"
        "google.golang.org/grpc/status"
        "strings"
)

var invalidAttribute *InvalidAttributeError
var useCaseError *UseCaseError
var notFoundError *NotFoundError
var permissionDeniedError *PermissionDeniedError

func NewGrpcError(err error) error <span class="cov8" title="1">{
        if errors.As(err, &amp;invalidAttribute) </span><span class="cov8" title="1">{
                return status.Error(codes.InvalidArgument, err.Error())
        }</span>

        <span class="cov8" title="1">if errors.As(err, &amp;useCaseError) </span><span class="cov8" title="1">{
                parts := strings.Split(err.Error(), ":")
                if len(parts) &gt; 1 </span><span class="cov8" title="1">{
                        return status.Error(codes.Internal, fmt.Sprintf("%s.", parts[0]))
                }</span>
                <span class="cov8" title="1">return status.Error(codes.Internal, err.Error())</span>
        }

        <span class="cov8" title="1">if errors.As(err, &amp;notFoundError) </span><span class="cov8" title="1">{
                return status.Error(codes.NotFound, err.Error())
        }</span>

        <span class="cov8" title="1">if errors.As(err, &amp;permissionDeniedError) </span><span class="cov8" title="1">{
                return status.Error(codes.PermissionDenied, err.Error())
        }</span>

        <span class="cov8" title="1">return status.Error(codes.Internal, "Internal server error.")</span>
}
</pre>
		
		<pre class="file" id="file2" style="display: none">package errs

import "fmt"

type InvalidAttributeError struct {
        ClassName     string
        AttributeName string
        Reason        string
}

func NewInvalidAttributeError(ClassName string, AttributeName string, Reason string) *InvalidAttributeError <span class="cov8" title="1">{
        return &amp;InvalidAttributeError{
                ClassName:     ClassName,
                AttributeName: AttributeName,
                Reason:        Reason,
        }
}</span>

func (ia *InvalidAttributeError) Error() string <span class="cov8" title="1">{
        return fmt.Sprintf("[%s] Invalid '%s': %s.",
                ia.ClassName,
                ia.AttributeName,
                ia.Reason)
}</span>
</pre>
		
		<pre class="file" id="file3" style="display: none">package errs

import "fmt"

type NotFoundError struct {
        name string
}

func NewNotFoundError(Name string) *NotFoundError <span class="cov8" title="1">{
        return &amp;NotFoundError{Name}
}</span>

func (nf *NotFoundError) Error() string <span class="cov8" title="1">{
        return fmt.Sprintf("%s not found.", nf.name)
}</span>
</pre>
		
		<pre class="file" id="file4" style="display: none">package errs

import "fmt"

type PermissionDeniedError struct {
        action string
}

func NewPermissionDeniedError(Action string) *PermissionDeniedError <span class="cov8" title="1">{
        return &amp;PermissionDeniedError{
                action: Action,
        }
}</span>

func (pd *PermissionDeniedError) Error() string <span class="cov8" title="1">{
        return fmt.Sprintf("Permission denied to %s.", pd.action)
}</span>
</pre>
		
		<pre class="file" id="file5" style="display: none">package errs

import "fmt"

type UseCaseError struct {
        usecase   string
        message   string
        wrapError error
}

func (uc *UseCaseError) Error() string <span class="cov8" title="1">{
        if uc.wrapError != nil </span><span class="cov8" title="1">{
                return fmt.Sprintf("[%s] %s: %s", uc.usecase, uc.message, uc.wrapError)
        }</span>
        <span class="cov8" title="1">return fmt.Sprintf("[%s] %s.", uc.usecase, uc.message)</span>
}

func (uc *UseCaseError) Unwrap() error <span class="cov8" title="1">{
        return uc.wrapError
}</span>

func NewCreateUserUseCaseError(Message string, error error) *UseCaseError <span class="cov8" title="1">{
        return &amp;UseCaseError{
                usecase:   "Create User",
                message:   Message,
                wrapError: error,
        }
}</span>

func NewUpdateCourseUseCaseError(Message string, error error) *UseCaseError <span class="cov0" title="0">{
        return &amp;UseCaseError{
                usecase:   "Update Course",
                message:   Message,
                wrapError: error,
        }
}</span>

func NewDeleteCourseUseCaseError(Message string, error error) *UseCaseError <span class="cov0" title="0">{
        return &amp;UseCaseError{
                usecase:   "Delete Course",
                message:   Message,
                wrapError: error,
        }
}</span>

func NewCreateSectionUseCaseError(Message string, error error) *UseCaseError <span class="cov0" title="0">{
        return &amp;UseCaseError{
                usecase:   "Create Section",
                message:   Message,
                wrapError: error,
        }
}</span>

func NewUpdateSectionUseCaseError(Message string, error error) *UseCaseError <span class="cov0" title="0">{
        return &amp;UseCaseError{
                usecase:   "Update Section",
                message:   Message,
                wrapError: error,
        }
}</span>

func NewDeleteSectionUseCaseError(Message string, error error) *UseCaseError <span class="cov0" title="0">{
        return &amp;UseCaseError{
                usecase:   "Delete Section",
                message:   Message,
                wrapError: error,
        }
}</span>

func NewVideoUploadUseCaseError(Message string, error error) *UseCaseError <span class="cov0" title="0">{
        return &amp;UseCaseError{
                usecase:   "Video Upload",
                message:   Message,
                wrapError: error,
        }
}</span>
</pre>
		
		<pre class="file" id="file6" style="display: none">package usecases

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type CreateCourseUseCase struct {
        peopleRepository ports.PeopleRepository
        courseRepository ports.CourseRepository
}

func NewCreateCourseUseCase(
        PeopleRepository ports.PeopleRepository,
        CourseRepository ports.CourseRepository,
) *CreateCourseUseCase <span class="cov8" title="1">{
        return &amp;CreateCourseUseCase{
                peopleRepository: PeopleRepository,
                courseRepository: CourseRepository,
        }
}</span>

type CreateCourseInstructorDTO struct {
        Id   string
        Name string
        Type string
}

type CreateCourseUseCaseDTO struct {
        Name        string
        Description string
        Instructor  CreateCourseInstructorDTO
}

func (cc *CreateCourseUseCase) Execute(Data CreateCourseUseCaseDTO) (*entities.Course, error) <span class="cov8" title="1">{
        people, err := entities.NewPeople(
                Data.Instructor.Id,
                Data.Instructor.Name,
                Data.Instructor.Type,
                nil,
        )
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">if err := cc.peopleRepository.Upsert(people); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewCreateUserUseCaseError("Could not insert or update people", err)
        }</span>

        <span class="cov8" title="1">course, err := entities.NewCourse(
                Data.Name,
                Data.Description,
                nil,
                Data.Instructor.Id,
        )
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">if err := cc.courseRepository.Create(course); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewCreateUserUseCaseError("Could not create course", err)
        }</span>

        <span class="cov8" title="1">return course, nil</span>
}
</pre>
		
		<pre class="file" id="file7" style="display: none">package usecases

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type CreateSectionUseCase struct {
        coursesRepository ports.CourseRepository
}

func NewCreateSectionUseCase(
        CoursesRepository ports.CourseRepository,
) *CreateSectionUseCase <span class="cov8" title="1">{
        return &amp;CreateSectionUseCase{CoursesRepository}
}</span>

type CreateSectionDTO struct {
        UserId      string
        CourseId    string
        Name        string
        Description string
}

func (cs *CreateSectionUseCase) Execute(Data CreateSectionDTO) (*entities.Course, error) <span class="cov8" title="1">{
        section, err := entities.NewCourseSection(Data.Name, Data.Description, Data.CourseId)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">course, _ := cs.coursesRepository.FindById(Data.CourseId)
        if course == nil </span><span class="cov8" title="1">{
                return nil, errs.NewNotFoundError("Course")
        }</span>
        <span class="cov8" title="1">if course.InstructorID() != Data.UserId </span><span class="cov8" title="1">{
                return nil, errs.NewPermissionDeniedError("create section")
        }</span>

        <span class="cov8" title="1">course.AddSection(section)

        if err := cs.coursesRepository.Update(course); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewCreateSectionUseCaseError("Could not create section", err)
        }</span>
        <span class="cov8" title="1">return course, nil</span>
}
</pre>
		
		<pre class="file" id="file8" style="display: none">package usecases

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type DeleteCourseUseCase struct {
        courseRepository ports.CourseRepository
}

func NewDeleteCourseUseCase(CourseRepository ports.CourseRepository) *DeleteCourseUseCase <span class="cov8" title="1">{
        return &amp;DeleteCourseUseCase{CourseRepository}
}</span>

type DeleteCourseUseCaseDataDTO struct {
        Id     string
        UserId string
}

func (dc *DeleteCourseUseCase) Execute(Data DeleteCourseUseCaseDataDTO) error <span class="cov8" title="1">{
        findCourse, _ := dc.courseRepository.FindById(Data.Id)
        if findCourse == nil </span><span class="cov8" title="1">{
                return errs.NewNotFoundError("Course")
        }</span>
        <span class="cov8" title="1">if findCourse.InstructorID() != Data.UserId </span><span class="cov8" title="1">{
                return errs.NewPermissionDeniedError("delete course")
        }</span>

        <span class="cov8" title="1">if err := dc.courseRepository.Delete(Data.Id); err != nil </span><span class="cov8" title="1">{
                return errs.NewDeleteCourseUseCaseError("Could not delete course", err)
        }</span>
        
        <span class="cov8" title="1">return nil</span>
}
</pre>
		
		<pre class="file" id="file9" style="display: none">package usecases

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type DeleteSectionUseCase struct {
        coursesRepository ports.CourseRepository
}

func NewDeleteSectionUseCase(CoursesRepository ports.CourseRepository) *DeleteSectionUseCase <span class="cov8" title="1">{
        return &amp;DeleteSectionUseCase{CoursesRepository}
}</span>

type DeleteSectionDTO struct {
        UserId    string
        CourseId  string
        SectionId string
}

func (ds *DeleteSectionUseCase) Execute(Data DeleteSectionDTO) error <span class="cov8" title="1">{
        course, _ := ds.coursesRepository.FindById(Data.CourseId)
        if course == nil </span><span class="cov8" title="1">{
                return errs.NewDeleteSectionUseCaseError("Course not found", nil)
        }</span>
        <span class="cov8" title="1">if course.InstructorID() != Data.UserId </span><span class="cov8" title="1">{
                return errs.NewPermissionDeniedError("update section")
        }</span>

        <span class="cov8" title="1">if err := course.RemoveSection(Data.SectionId); err != nil </span><span class="cov8" title="1">{
                return errs.NewNotFoundError("Section")
        }</span>

        <span class="cov8" title="1">if err := ds.coursesRepository.Update(course); err != nil </span><span class="cov8" title="1">{
                return errs.NewDeleteSectionUseCaseError("Could not delete section", err)
        }</span>
        <span class="cov8" title="1">return nil</span>
}
</pre>
		
		<pre class="file" id="file10" style="display: none">package usecases

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type UpdateCourseUseCase struct {
        peopleRepository ports.PeopleRepository
        courseRepository ports.CourseRepository
}

func NewUpdateCourseUseCase(
        PeopleRepository ports.PeopleRepository,
        CourseRepository ports.CourseRepository,
) *UpdateCourseUseCase <span class="cov8" title="1">{
        return &amp;UpdateCourseUseCase{
                PeopleRepository,
                CourseRepository,
        }
}</span>

type UpdateCourseInstructorDTO struct {
        Id   string
        Name string
        Type string
}

type UpdateCourseUseCaseDTO struct {
        Id          string
        Name        string
        Description string
        Instructor  UpdateCourseInstructorDTO
}

func (uc *UpdateCourseUseCase) Execute(Data UpdateCourseUseCaseDTO) (*entities.Course, error) <span class="cov8" title="1">{
        course, _ := uc.courseRepository.FindById(Data.Id)
        if course == nil </span><span class="cov8" title="1">{
                return nil, errs.NewNotFoundError("Course")
        }</span>

        <span class="cov8" title="1">if course.InstructorID() != Data.Instructor.Id </span><span class="cov8" title="1">{
                return nil, errs.NewPermissionDeniedError("update course")
        }</span>

        <span class="cov8" title="1">people, err := entities.NewPeople(Data.Instructor.Id, Data.Instructor.Name, Data.Instructor.Type, nil)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">if err := uc.peopleRepository.Upsert(people); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewUpdateCourseUseCaseError("Could not insert or update people", err)
        }</span>

        <span class="cov8" title="1">if err := course.Update(Data.Name, Data.Description); err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">if err := uc.courseRepository.Update(course); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewUpdateCourseUseCaseError("Could not update course", err)
        }</span>

        <span class="cov8" title="1">return course, nil</span>
}
</pre>
		
		<pre class="file" id="file11" style="display: none">package usecases

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type UpdateSectionUseCase struct {
        coursesRepository ports.CourseRepository
}

func NewUpdateSectionUseCase(
        CoursesRepository ports.CourseRepository,
) *UpdateSectionUseCase <span class="cov8" title="1">{
        return &amp;UpdateSectionUseCase{CoursesRepository}
}</span>

type UpdateSectionDTO struct {
        UserId      string
        CourseId    string
        SectionId   string
        Name        string
        Description string
}

func (cs *UpdateSectionUseCase) Execute(Data UpdateSectionDTO) (*entities.Course, error) <span class="cov8" title="1">{
        course, _ := cs.coursesRepository.FindById(Data.CourseId)
        if course == nil </span><span class="cov8" title="1">{
                return nil, errs.NewUpdateSectionUseCaseError("Course not found", nil)
        }</span>
        <span class="cov8" title="1">if course.InstructorID() != Data.UserId </span><span class="cov8" title="1">{
                return nil, errs.NewPermissionDeniedError("update section")
        }</span>

        <span class="cov8" title="1">section := course.FindSection(Data.SectionId)
        if section == nil </span><span class="cov8" title="1">{
                return nil, errs.NewNotFoundError("Section")
        }</span>

        <span class="cov8" title="1">if err := section.Update(Data.Name, Data.Description); err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">if err := cs.coursesRepository.Update(course); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewUpdateSectionUseCaseError("Could not update section", err)
        }</span>

        <span class="cov8" title="1">return course, nil</span>
}
</pre>
		
		<pre class="file" id="file12" style="display: none">package usecases

import (
        "fmt"
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/apptimer"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/entities"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/ports"
)

type VideoUpload struct {
        filesService ports.FilesService
        uuidService  ports.UUIDService
        repository   ports.VideosRepository
        video        *entities.Video
        size         int64
        chunkSize    int64
        timer        apptimer.Timer
}

func NewVideoUpload(
        FilesService ports.FilesService,
        UUIDService ports.UUIDService,
        VideosRepository ports.VideosRepository,
        Timer apptimer.Timer,
) *VideoUpload <span class="cov8" title="1">{
        return &amp;VideoUpload{
                filesService: FilesService,
                uuidService:  UUIDService,
                repository:   VideosRepository,
                timer:        Timer,
        }
}</span>

func (v *VideoUpload) CreateFile(Type string, Size int64) (*VideoUpload, error) <span class="cov8" title="1">{
        videoId := v.uuidService.Generate()
        videoUrl := fmt.Sprintf("/app/tmp/videos/%s.%s", videoId, Type)
        video, err := entities.NewVideo(v.timer, videoId, videoUrl, Type, Size)
        if err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">newService, err := v.filesService.CreateFile(ports.FileInfo{
                Url:  videoUrl,
                Size: Size,
                Type: Type,
        })
        if err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewVideoUploadUseCaseError("Could not create video", err)
        }</span>

        <span class="cov8" title="1">newVideoUpload := &amp;VideoUpload{
                video:        video,
                filesService: newService,
                repository:   v.repository,
        }
        return newVideoUpload, nil</span>
}

func (v *VideoUpload) SendChunk(data []byte) error <span class="cov8" title="1">{
        if v.video == nil </span><span class="cov8" title="1">{
                return errs.NewVideoUploadUseCaseError("Video has not been created", nil)
        }</span>

        <span class="cov8" title="1">if err := v.filesService.SendChunk(data); err != nil </span><span class="cov8" title="1">{
                return errs.NewVideoUploadUseCaseError("Could not send video chunk", err)
        }</span>
        <span class="cov8" title="1">v.size += int64(len(data))
        v.chunkSize = int64(len(data))

        return nil</span>
}

func (v *VideoUpload) Execute() (*entities.Video, error) <span class="cov8" title="1">{
        if v.video == nil </span><span class="cov8" title="1">{
                return nil, errs.NewVideoUploadUseCaseError("Video has not been created", nil)
        }</span>

        <span class="cov8" title="1">if err := v.filesService.Close(); err != nil </span><span class="cov8" title="1">{
                return nil, errs.NewVideoUploadUseCaseError("Could not save video", err)
        }</span>

        <span class="cov8" title="1">sizeDiff := v.video.Size() - v.size
        if v.size == 0 || sizeDiff &gt; v.chunkSize </span><span class="cov8" title="1">{
                v.filesService.Remove()
                return nil, errs.NewInvalidAttributeError(
                        "Video Upload",
                        "size",
                        fmt.Sprintf("Expected %d bytes, Received %d bytes", v.video.Size(), v.size),
                )
        }</span>

        <span class="cov8" title="1">if err := v.repository.Create(v.video); err != nil </span><span class="cov8" title="1">{
                v.filesService.Remove()
                return nil, errs.NewVideoUploadUseCaseError("Could not save video", err)
        }</span>

        <span class="cov0" title="0">return v.video, nil</span>
}

func (v *VideoUpload) Video() *entities.Video <span class="cov8" title="1">{
        return v.video
}</span>
</pre>
		
		<pre class="file" id="file13" style="display: none">package entities

import (
        "github.com/google/uuid"
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        value_objects "github.com/matheusvmallmann/plataforma-ead/service-course/domain/value-objects"
        "time"
)

type Course struct {
        id           string
        name         string
        description  string
        image        *value_objects.Image
        instructorID string
        sections     []*CourseSection
        visible      bool
        createdAt    time.Time
        updatedAt    time.Time
}

func NewCourse(Name string, Description string, Image *value_objects.Image, InstructorId string) (*Course, error) <span class="cov8" title="1">{
        course := &amp;Course{
                id:           uuid.NewString(),
                name:         Name,
                description:  Description,
                image:        Image,
                instructorID: InstructorId,
                visible:      false,
                createdAt:    time.Now(),
        }
        if err := course.Validate(); err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">return course, nil</span>
}

func NewCourseComplete(
        Id string, Name string, Description string, Image *value_objects.Image,
        InstructorId string, Visible bool, CreatedAt time.Time, UpdatedAt time.Time,
) *Course <span class="cov0" title="0">{
        return &amp;Course{
                id: Id, name: Name, description: Description, image: Image, instructorID: InstructorId,
                visible: Visible, createdAt: CreatedAt, updatedAt: UpdatedAt,
        }
}</span>

func (c *Course) Validate() error <span class="cov8" title="1">{
        if len(c.name) &lt; 5 </span><span class="cov8" title="1">{
                return errs.NewInvalidAttributeError(
                        "Course",
                        "name",
                        "must be longer than 5")
        }</span>
        <span class="cov8" title="1">if len(c.description) &lt; 20 </span><span class="cov8" title="1">{
                return errs.NewInvalidAttributeError(
                        "Course",
                        "description",
                        "must be longer than 20")
        }</span>

        <span class="cov8" title="1">return nil</span>
}

func (c *Course) Update(Name string, Description string) error <span class="cov0" title="0">{
        c.name = Name
        c.description = Description
        c.updatedAt = time.Now()
        return c.Validate()
}</span>

func (c *Course) AddSection(Section *CourseSection) <span class="cov8" title="1">{
        c.sections = append(c.sections, Section)
}</span>

func (c *Course) RemoveSection(Id string) error <span class="cov8" title="1">{
        findKey := -1
        for key, section := range c.sections </span><span class="cov8" title="1">{
                if section.Id() == Id </span><span class="cov8" title="1">{
                        findKey = key
                }</span>
        }
        <span class="cov8" title="1">if findKey &lt; 0 </span><span class="cov8" title="1">{
                return errs.NewNotFoundError("Section")
        }</span>
        <span class="cov8" title="1">c.sections = append(c.sections[:findKey], c.sections[findKey+1:]...)
        return nil</span>
}

func (c *Course) FindSection(Id string) *CourseSection <span class="cov8" title="1">{
        for _, valor := range c.sections </span><span class="cov8" title="1">{
                if valor.id == Id </span><span class="cov8" title="1">{
                        return valor
                }</span>
        }
        <span class="cov8" title="1">return nil</span>
}

func (c *Course) Id() string <span class="cov8" title="1">{
        return c.id
}</span>

func (c *Course) Name() string <span class="cov0" title="0">{
        return c.name
}</span>

func (c *Course) Description() string <span class="cov0" title="0">{
        return c.description
}</span>

func (c *Course) Image() *value_objects.Image <span class="cov0" title="0">{
        return c.image
}</span>

func (c *Course) InstructorID() string <span class="cov0" title="0">{
        return c.instructorID
}</span>

func (c *Course) Sections() []*CourseSection <span class="cov8" title="1">{
        return c.sections
}</span>

func (c *Course) IsVisible() bool <span class="cov8" title="1">{
        return c.visible
}</span>

func (c *Course) CreatedAt() time.Time <span class="cov0" title="0">{
        return c.createdAt
}</span>

func (c *Course) UpdatedAt() time.Time <span class="cov0" title="0">{
        return c.updatedAt
}</span>
</pre>
		
		<pre class="file" id="file14" style="display: none">package entities

import "time"

type CourseItem struct {
        id          string
        title       string
        description string
        sectionId   string
        itemType    string
        video       Video
        createdAt   time.Time
        updatedAt   time.Time
}

func NewCourseItem(
        Id string,
        Title string,
        Description string,
        SectionId string,
        Type string,
        Video Video,
) *CourseItem <span class="cov0" title="0">{
        return &amp;CourseItem{
                id:          Id,
                title:       Title,
                description: Description,
                sectionId:   SectionId,
                itemType:    Type,
                video:       Video,
        }
}</span>

func (c CourseItem) Id() string <span class="cov0" title="0">{
        return c.id
}</span>

func (c CourseItem) Title() string <span class="cov0" title="0">{
        return c.title
}</span>

func (c CourseItem) Description() string <span class="cov0" title="0">{
        return c.description
}</span>

func (c CourseItem) SectionId() string <span class="cov0" title="0">{
        return c.sectionId
}</span>

func (c CourseItem) Type() string <span class="cov0" title="0">{
        return c.itemType
}</span>

func (c CourseItem) Video() Video <span class="cov0" title="0">{
        return c.video
}</span>

func (c CourseItem) CreatedAt() time.Time <span class="cov0" title="0">{
        return c.createdAt
}</span>

func (c CourseItem) UpdatedAt() time.Time <span class="cov0" title="0">{
        return c.updatedAt
}</span>
</pre>
		
		<pre class="file" id="file15" style="display: none">package entities

import (
        "github.com/google/uuid"
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "time"
)

type CourseSection struct {
        id          string
        name        string
        description string
        courseId    string
        itens       []*CourseItem
        createdAt   time.Time
        updatedAt   time.Time
}

func NewCourseSection(Name string, Description string, CourseId string) (*CourseSection, error) <span class="cov8" title="1">{
        section := &amp;CourseSection{
                id:          uuid.NewString(),
                name:        Name,
                description: Description,
                courseId:    CourseId,
                createdAt:   time.Now(),
        }
        if err := section.Validate(); err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">return section, nil</span>
}

type NewCompleteSectionData struct {
        Id          string
        Name        string
        Description string
        CourseId    string
        CreatedAt   time.Time
        UpdatedAt   time.Time
}

func NewCompleteSection(data NewCompleteSectionData) *CourseSection <span class="cov0" title="0">{
        return &amp;CourseSection{
                id:          data.Id,
                name:        data.Name,
                description: data.Description,
                courseId:    data.CourseId,
                createdAt:   data.CreatedAt,
                updatedAt:   data.UpdatedAt,
        }
}</span>

func (cs *CourseSection) Update(Name string, Description string) error <span class="cov0" title="0">{
        cs.name = Name
        cs.description = Description
        return cs.Validate()
}</span>

func (cs *CourseSection) Validate() error <span class="cov8" title="1">{
        if len(cs.name) &lt; 5 </span><span class="cov8" title="1">{
                return errs.NewInvalidAttributeError(
                        "Course Section",
                        "name",
                        "must be longer than 5")
        }</span>
        <span class="cov8" title="1">return nil</span>
}

func (cs *CourseSection) Id() string <span class="cov8" title="1">{
        return cs.id
}</span>

func (cs *CourseSection) Name() string <span class="cov0" title="0">{
        return cs.name
}</span>

func (cs *CourseSection) Description() string <span class="cov0" title="0">{
        return cs.description
}</span>

func (cs *CourseSection) CourseId() string <span class="cov0" title="0">{
        return cs.courseId
}</span>

func (cs *CourseSection) Itens() []*CourseItem <span class="cov0" title="0">{
        return cs.itens
}</span>

func (cs *CourseSection) CreatedAt() time.Time <span class="cov0" title="0">{
        return cs.createdAt
}</span>

func (cs *CourseSection) UpdatedAt() time.Time <span class="cov0" title="0">{
        return cs.updatedAt
}</span>
</pre>
		
		<pre class="file" id="file16" style="display: none">package entities

import (
        "github.com/google/uuid"
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        value_objects "github.com/matheusvmallmann/plataforma-ead/service-course/domain/value-objects"
        "time"
)

type People struct {
        id         string
        name       string
        peopleType string
        photo      *value_objects.Image
        createdAt  time.Time
        updatedAt  time.Time
}

func NewPeople(Id string, Name string, Type string, Photo *value_objects.Image) (*People, error) <span class="cov8" title="1">{
        people := &amp;People{
                id:         Id,
                name:       Name,
                peopleType: Type,
                photo:      Photo,
                createdAt:  time.Now(),
        }
        if err := people.Validate(); err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>
        <span class="cov8" title="1">return people, nil</span>
}

func (p *People) Validate() error <span class="cov8" title="1">{
        if _, err := uuid.Parse(p.id); err != nil </span><span class="cov8" title="1">{
                return errs.NewInvalidAttributeError("People", "id", "must be valid UUID")
        }</span>
        <span class="cov8" title="1">if len(p.name) &lt; 5 </span><span class="cov8" title="1">{
                return errs.NewInvalidAttributeError("People", "name", "must be longer than 5")
        }</span>
        <span class="cov8" title="1">return nil</span>
}

func (p *People) Update(Name string, Image *value_objects.Image) error <span class="cov0" title="0">{
        p.name = Name
        p.photo = Image
        return p.Validate()
}</span>

func (p *People) Id() string <span class="cov0" title="0">{
        return p.id
}</span>

func (p *People) Name() string <span class="cov0" title="0">{
        return p.name
}</span>

func (p *People) Photo() *value_objects.Image <span class="cov0" title="0">{
        return p.photo
}</span>

func (p *People) GetType() string <span class="cov0" title="0">{
        return p.peopleType
}</span>
</pre>
		
		<pre class="file" id="file17" style="display: none">package entities

import (
        errs "github.com/matheusvmallmann/plataforma-ead/service-course/application/errors"
        "github.com/matheusvmallmann/plataforma-ead/service-course/domain/apptimer"
        "time"
)

type Video struct {
        timer     apptimer.Timer
        id        string
        videoType string
        tmpUrl    string
        processed bool
        duration  float32
        size      int64
        createdAt time.Time
        updatedAt time.Time
}

func NewVideo(Timer apptimer.Timer, Id string, TmpUrl string, Type string, Size int64) (*Video, error) <span class="cov8" title="1">{
        video := &amp;Video{
                timer:     Timer,
                id:        Id,
                tmpUrl:    TmpUrl,
                videoType: Type,
                processed: false,
                size:      Size,
                createdAt: Timer.Now(),
        }

        if err := video.Validate(); err != nil </span><span class="cov8" title="1">{
                return nil, err
        }</span>

        <span class="cov8" title="1">return video, nil</span>
}

func (v *Video) Validate() error <span class="cov8" title="1">{
        if v.videoType != "mp4" </span><span class="cov8" title="1">{
                return errs.NewInvalidAttributeError(
                        "Video",
                        "type",
                        "must be mp4.",
                )
        }</span>

        <span class="cov8" title="1">return nil</span>
}

func (v *Video) Id() string <span class="cov8" title="1">{
        return v.id
}</span>

func (v *Video) Type() string <span class="cov8" title="1">{
        return v.videoType
}</span>

func (v *Video) TmpUrl() string <span class="cov8" title="1">{
        return v.tmpUrl
}</span>

func (v *Video) Processed() bool <span class="cov8" title="1">{
        return v.processed
}</span>

func (v *Video) Duration() float32 <span class="cov0" title="0">{
        return v.duration
}</span>

func (v *Video) Size() int64 <span class="cov8" title="1">{
        return v.size
}</span>

func (v *Video) CreatedAt() time.Time <span class="cov8" title="1">{
        return v.createdAt
}</span>

func (v *Video) UpdatedAt() time.Time <span class="cov0" title="0">{
        return v.updatedAt
}</span>
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
